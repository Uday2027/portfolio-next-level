{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 16, "column": 0}, "map": {"version":3,"sources":["turbopack:///[project]/lib/auth.ts"],"sourcesContent":["\nimport { SignJWT, jwtVerify } from \"jose\";\nimport { cookies } from \"next/headers\";\nimport { NextResponse } from \"next/server\";\n\nconst SECRET_KEY = process.env.JWT_SECRET || \"default_secret_key_change_me_in_prod\";\nconst key = new TextEncoder().encode(SECRET_KEY);\n\nexport async function signToken(payload: any) {\n  return await new SignJWT(payload)\n    .setProtectedHeader({ alg: \"HS256\" })\n    .setIssuedAt()\n    .setExpirationTime(\"24h\")\n    .sign(key);\n}\n\nexport async function verifyToken(token: string) {\n  try {\n    const { payload } = await jwtVerify(token, key, { algorithms: [\"HS256\"] });\n    return payload;\n  } catch (error) {\n    return null;\n  }\n}\n\nexport async function getSession() {\n  const cookieStore = await cookies();\n  const token = cookieStore.get(\"auth_token\")?.value;\n  if (!token) return null;\n  return await verifyToken(token);\n}\n"],"names":[],"mappings":";;;;;;;;AACA;AAAA;AACA;AAAA;;;AAGA,MAAM,aAAa,QAAQ,GAAG,CAAC,UAAU,IAAI;AAC7C,MAAM,MAAM,IAAI,cAAc,MAAM,CAAC;AAE9B,eAAe,UAAU,OAAY;IAC1C,OAAO,MAAM,IAAI,wKAAO,CAAC,SACtB,kBAAkB,CAAC;QAAE,KAAK;IAAQ,GAClC,WAAW,GACX,iBAAiB,CAAC,OAClB,IAAI,CAAC;AACV;AAEO,eAAe,YAAY,KAAa;IAC7C,IAAI;QACF,MAAM,EAAE,OAAO,EAAE,GAAG,MAAM,IAAA,4KAAS,EAAC,OAAO,KAAK;YAAE,YAAY;gBAAC;aAAQ;QAAC;QACxE,OAAO;IACT,EAAE,OAAO,OAAO;QACd,OAAO;IACT;AACF;AAEO,eAAe;IACpB,MAAM,cAAc,MAAM,IAAA,sLAAO;IACjC,MAAM,QAAQ,YAAY,GAAG,CAAC,eAAe;IAC7C,IAAI,CAAC,OAAO,OAAO;IACnB,OAAO,MAAM,YAAY;AAC3B"}},
    {"offset": {"line": 59, "column": 0}, "map": {"version":3,"sources":["turbopack:///[project]/middleware.ts"],"sourcesContent":["\nimport { NextResponse } from \"next/server\";\nimport type { NextRequest } from \"next/server\";\nimport { verifyToken } from \"@/lib/auth\";\n\nexport async function middleware(request: NextRequest) {\n  // Check if accessing protected admin routes\n  if (request.nextUrl.pathname.startsWith(\"/me/dashboard\")) {\n    const token = request.cookies.get(\"auth_token\")?.value;\n    \n    // Always allow if checking auth, otherwise verify\n    if (!token || !(await verifyToken(token))) {\n      return NextResponse.redirect(new URL(\"/me\", request.url));\n    }\n  }\n\n  return NextResponse.next();\n}\n\nexport const config = {\n  matcher: [\"/me/dashboard/:path*\"],\n};\n"],"names":[],"mappings":";;;;;;AACA;AAAA;AAEA;;;AAEO,eAAe,WAAW,OAAoB;IACnD,4CAA4C;IAC5C,IAAI,QAAQ,OAAO,CAAC,QAAQ,CAAC,UAAU,CAAC,kBAAkB;QACxD,MAAM,QAAQ,QAAQ,OAAO,CAAC,GAAG,CAAC,eAAe;QAEjD,kDAAkD;QAClD,IAAI,CAAC,SAAS,CAAE,MAAM,IAAA,kIAAW,EAAC,QAAS;YACzC,OAAO,gMAAY,CAAC,QAAQ,CAAC,IAAI,IAAI,OAAO,QAAQ,GAAG;QACzD;IACF;IAEA,OAAO,gMAAY,CAAC,IAAI;AAC1B;AAEO,MAAM,SAAS;IACpB,SAAS;QAAC;KAAuB;AACnC"}}]
}